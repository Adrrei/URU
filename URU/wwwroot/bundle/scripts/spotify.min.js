"use strict";function handleLocalStorage(){var n=getItemFromStorage("StorageDuration"),t,i;if(n)t=new Date(JSON.parse(JSON.stringify(new Date))),i=new Date(JSON.parse(JSON.stringify(n.StorageDuration))),t>i&&(localStorage.removeItem("StorageDuration"),localStorage.removeItem("Genres"),localStorage.removeItem("Artists"),localStorage.removeItem("Hours"));else{let n=new Date;n.setHours(n.getHours()+3);setItemInStorage("StorageDuration",{StorageDuration:JSON.parse(JSON.stringify(n))})}}function setItemInStorage(n,t){localStorage.setItem(n,JSON.stringify(t))}function getItemFromStorage(n){var t=localStorage.getItem(n);return t?JSON.parse(t):null}function getSpotifyPlaytime(){var t=getItemFromStorage("Hours"),n;if(t){document.getElementsByClassName("loading")[0].classList.remove("loading");document.getElementById("spotify-playtime").textContent=t.Hours;return}n=new XMLHttpRequest;n.open("GET",uru.Urls.GetSpotifyPlaytime,!0);n.responseType="json";n.send();n.onload=function(){var r,t,i;n.status===200&&(document.getElementsByClassName("loading")[0].classList.remove("loading"),r=n.response,t=parseInt(r.hours),setItemInStorage("Hours",{Hours:t}),i=0,setInterval(function(){i++>=t||(document.getElementById("spotify-playtime").textContent=i)},15))}}function getSpotifyLatestAddition(){var t=getItemFromStorage("Genres"),n;t&&createTableSpotifyGenres(t.Genres);n=new XMLHttpRequest;n.open("GET",uru.Urls.GetSpotifyPlaylists,!0);n.responseType="json";n.send();n.onload=function(){if(n.status===200){var r=n.response,i=document.createElement("iframe");if(i.src="https://open.spotify.com/embed/track/"+r.exquisiteEdm.items[0].track.id,i.height=80,i.width=300,i.setVolume=.1,document.getElementById("spotify-latest-addition").appendChild(i),t)return;createTableSpotifyGenres(r.genres);setItemInStorage("Genres",{Genres:r.genres})}}}function createTableSpotifyGenres(n){var r=document.getElementById("table-genres").getElementsByTagName("tbody")[0],t,i;for(t in n)i='<tr><th class="left">'+t+'<\/th><td class="right">'+n[t]+"<\/td><\/tr>",r.innerHTML+=i}function resetGetSpotifyFavorites(){document.getElementById("cards").innerHTML="";getSpotifyFavorites(0)}function getSpotifyFavorites(n){var f=document.getElementById("cards"),u=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i="/content/images/Spotify-",r,t;switch(!0){case u>580:i+="240x240.png";break;case u>344:i+="320x80.png";break;case u>320:i+="300x80.png";break;default:i+="260x80.png"}for(let n=0;n<5;n++)r=new Image,r.onload=function(){f.src=this.src},r.src=i,r.classList.add("spotify-card-margin"),f.appendChild(r);t=new XMLHttpRequest;t.open("GET",uru.Urls.GetSpotifyFavorites,!0);t.responseType="json";t.send();t.onload=function(){var i,r,u;t.status===200&&(i=t.response.favorites,r=document.getElementById("spotify-favorites-count"),r.textContent=i.length,u=document.getElementById("cards").childNodes,i.forEach(function(t){var i=document.createElement("iframe");i.src="https://open.spotify.com/embed/track/"+t;i.height=240;i.width=240;i.setVolume=.1;document.getElementById("cards").replaceChild(i,u[n++])}))}}function resetTableSpotifyArtists(){var n=document.getElementById("spotify-set-artist-count").value;getSpotifyTopArtists(n)}function getSpotifyTopArtists(n){var i=getItemFromStorage("Artists"),t,r;if(n===""&&(n=10),i&&i.Artists.length===parseInt(n)){createTableSpotifyArtists(i.Artists);return}t=new XMLHttpRequest;t.open("POST",uru.Urls.GetSpotifyTopArtists,!0);t.responseType="json";r=new FormData;r.append("numberOfArtists",n);t.send(r);t.onload=function(){if(t.status===200){var n=t.response.artists;createTableSpotifyArtists(n);setItemInStorage("Artists",{Artists:n})}}}function createTableSpotifyArtists(n){var t=document.getElementById("table-top-artists").getElementsByTagName("tbody")[0],i;t.innerHTML="";for(let r=0;r<n.length;r++)i='<tr><th class="left">'+n[r].key+'<\/th><td class="right">'+n[r].value+"<\/td><\/tr>",t.innerHTML+=i}window.onload=function(){getSpotifyLatestAddition();getSpotifyFavorites(1);getSpotifyPlaytime();getSpotifyTopArtists(10);handleLocalStorage();document.getElementById("spotify-set-artist-count").addEventListener("blur",resetTableSpotifyArtists)};