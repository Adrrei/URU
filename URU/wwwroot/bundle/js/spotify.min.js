"use strict";function prepareTable(n,t,i,r,u,f,e){e===1?(n.classList.remove("hidden"),r.classList.add("checked")):(n.classList.add("hidden"),r.classList.remove("checked"));e===2?(t.classList.remove("hidden"),u.classList.add("checked")):(t.classList.add("hidden"),u.classList.remove("checked"));e===3?(i.classList.remove("hidden"),f.classList.add("checked")):(i.classList.add("hidden"),f.classList.remove("checked"))}function getDetailsArtists(){let n=getItemFromStorage("Playtime"),t=getItemFromStorage("Songs"),i=getItemFromStorage("Artists");if(n&&t&&i){let r=document.getElementById("hours");r.textContent=n.hours;r.classList.remove("loading");let u=document.getElementById("songs");u.textContent=t.songs;u.classList.remove("loading");createTable(i.artists,"artists");return}fetch("/Spotify/GetIdDurationArtists").then(function(n){return n.json()}).then(function(n){let t=n.time,i=n.songs,r=document.getElementById("hours");r.textContent=t;r.classList.remove("loading");let u=document.getElementById("songs");u.textContent=i;u.classList.remove("loading");let f=n.artists;createTable(f,"artists");setItemInStorage("Playtime",{hours:t});setItemInStorage("Songs",{songs:i});setItemInStorage("Artists",{artists:f})})}function getTracksByYear(){let n=getItemFromStorage("TracksByYear");if(n){createTable(n.tracks,"tracks-by-year");return}fetch("/Spotify/GetTracksByYear").then(function(n){return n.json()}).then(function(n){let t=n.tracksByYear;createTable(t,"tracks-by-year");setItemInStorage("TracksByYear",{tracks:t})})}function getGenres(){let n=getItemFromStorage("Genres");if(n){createTable(n.genres,"genres");return}fetch("/Spotify/GetGenres").then(function(n){return n.json()}).then(function(n){let t=n.genres;createTable(t,"genres");setItemInStorage("Genres",{genres:t})})}function getFavorites(){let n=getItemFromStorage("Favorites");if(n){displayFavorites(n.favorites);return}fetch("/Spotify/GetFavorites").then(function(n){return n.json()}).then(function(n){let t=n.favorites;displayFavorites(t);setItemInStorage("Favorites",{favorites:t})})}function displayFavorites(n){let r=[];for(let t=0;t<5;t++)next++>n.length-1&&(next=0),r.push(n.splice(next,1));let u=window.innerWidth,t,i;switch(!0){case u>880:t=245;i=245;break;case u>360:t=320;i=80;break;default:t=260;i=80}for(let n=0;n<4;n++){let u=document.createElement("iframe");u.src="https://open.spotify.com/embed/track/"+r[n];u.height=i;u.width=t;let f=document.getElementById("favorites").getElementsByClassName("column")[n];f.innerHTML="";f.appendChild(u)}}function randomNumber(n){return Math.floor(Math.random()*n)}function createTable(n,t){let i=document.getElementById(t).getElementsByTagName("tbody")[0];i.innerHTML="";Object.keys(n).forEach(t=>{let u=n[t],r=i.insertRow(),f=r.insertCell(0),e=r.insertCell(1);u.item1?(f.textContent=t,e.textContent=u.item1,r.setAttribute("data-uri",u.item2),r.addEventListener("click",function(){window.location.href=r.dataset.uri})):(f.textContent=u.key,e.textContent=u.value);r.appendChild(f);r.appendChild(e);i.appendChild(r)})}function handleLocalStorage(){let t=getItemFromStorage("Reset");if(t){var i=new Date,r=new Date(t.date);if(i>r)localStorage.clear();else return}let n=new Date;n.setHours(n.getHours()+3);setItemInStorage("Reset",{date:n})}function setItemInStorage(n,t){localStorage.setItem(n,JSON.stringify(t))}function getItemFromStorage(n){let t=localStorage.getItem(n);return t?JSON.parse(t):null}document.addEventListener("DOMContentLoaded",function(){getGenres();getFavorites();getTracksByYear();getDetailsArtists();let e=document.getElementById("reset-favorites");e.addEventListener("click",function(){getFavorites()});let r=document.getElementById("genres"),n=document.getElementById("toggle-genres"),u=document.getElementById("artists"),t=document.getElementById("toggle-artists"),f=document.getElementById("tracks-by-year"),i=document.getElementById("toggle-tracks-by-year");n.addEventListener("click",function(){prepareTable(r,u,f,n,t,i,1)});t.addEventListener("click",function(){prepareTable(r,u,f,n,t,i,2)});i.addEventListener("click",function(){prepareTable(r,u,f,n,t,i,3)});handleLocalStorage()});let next=0;