"use strict";function getIdDurationArtists(){let t=getItemFromStorage("Latest"),i=getItemFromStorage("Playtime"),r=getItemFromStorage("Artists"),n=document.createElement("iframe");if(n.height=80,n.width=300,t&&i&&r){n.src="https://open.spotify.com/embed/track/"+t.id;document.getElementById("latest").appendChild(n);document.getElementsByClassName("loading")[0].classList.remove("loading");document.getElementById("playtime").textContent=i.hours;createTable(r.artists,"table-artists");return}fetch("/Spotify/GetIdDurationArtists").then(function(n){return n.json()}).then(function(t){document.getElementsByClassName("loading")[0].classList.remove("loading");let i=t.time;document.getElementById("playtime").textContent=i;let r=t.latest;n.src="https://open.spotify.com/embed/track/"+r;document.getElementById("latest").appendChild(n);let u=t.artists;createTable(u,"table-artists");setItemInStorage("Playtime",{hours:i});setItemInStorage("Latest",{id:r});setItemInStorage("Artists",{artists:u})})}function getGenres(){let n=getItemFromStorage("Genres");n&&createTable(n.genres,"table-genres");fetch("/Spotify/GetGenres").then(function(n){return n.json()}).then(function(n){let t=n.genres;createTable(t,"table-genres");setItemInStorage("Genres",{genres:t})})}function getFavorites(){let i=window.innerWidth,n="/content/images/Spotify-";switch(!0){case i>580:n+="245x245.png";break;case i>344:n+="320x80.png";break;case i>320:n+="300x80.png";break;default:n+="260x80.png"}let r=document.getElementById("cards");r.innerHTML="";for(let i=0;i<5;i++){var t=new Image;t.onload=function(){r.src=this.src};t.src=n;t.classList.add("card-margin");r.appendChild(t)}fetch("/Spotify/GetFavorites").then(function(n){return n.json()}).then(function(n){let t=n.favorites,i=document.getElementById("favorites-count");i.textContent=t.length;let r=document.getElementById("cards").childNodes,u=0;t.forEach(function(n){let t=document.createElement("iframe");t.src="https://open.spotify.com/embed/track/"+n;t.height=245;t.width=245;document.getElementById("cards").replaceChild(t,r[u++])})})}function getTopArtists(n){let t=getItemFromStorage("Artists");if(t&&t.artists.length===parseInt(n)){createTable(t.artists,"table-artists");return}fetch("/Spotify/GetTopArtists?artists="+n).then(function(n){return n.json()}).then(function(n){let t=n.artists;createTable(t,"table-artists");setItemInStorage("Artists",{artists:t})})}function createTable(n,t){let i=document.getElementById(t).getElementsByTagName("tbody")[0];i.innerHTML="";Object.keys(n).forEach(t=>{let e=n[t],r=i.insertRow(),u=r.insertCell(0);u.classList.add("left");u.textContent=t;let f=r.insertCell(1);f.classList.add("right");f.textContent=e;r.appendChild(u);r.appendChild(f);i.appendChild(r)})}function handleLocalStorage(){let t=getItemFromStorage("Reset");if(t){var i=new Date,r=new Date(t.date);if(i>r)localStorage.clear();else return}let n=new Date;n.setHours(n.getHours()+3);setItemInStorage("Reset",{date:n})}function setItemInStorage(n,t){localStorage.setItem(n,JSON.stringify(t))}function getItemFromStorage(n){var t=localStorage.getItem(n);return t?JSON.parse(t):null}document.addEventListener("DOMContentLoaded",function(){getGenres();getFavorites();getIdDurationArtists();let n=document.getElementById("reset-favorites");n.addEventListener("click",function(){getFavorites()});let t=document.getElementById("set-artists");t.addEventListener("blur",function(){getTopArtists(this.value)});handleLocalStorage()});